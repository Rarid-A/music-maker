<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAW Music Maker - Studio</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- DAW Container -->
    <div class="daw-container">
        
        <!-- Top Bar (Header + Transport) -->
        <div class="top-bar">
            <div class="logo">
                <h1>üéµ Music Studio</h1>
            </div>
            
            <!-- Transport Controls -->
            <div class="transport-controls">
                <button id="playBtn" class="transport-btn" title="Play/Pause">
                    <span class="icon">‚ñ∂Ô∏è</span>
                </button>
                <button id="stopBtn" class="transport-btn" title="Stop">
                    <span class="icon">‚èπÔ∏è</span>
                </button>
                <button id="recordBtn" class="transport-btn record" title="Record">
                    <span class="icon">‚è∫Ô∏è</span>
                </button>
                
                <div class="tempo-display">
                    <label>BPM:</label>
                    <input type="number" id="tempoInput" value="120" min="40" max="200">
                </div>
                
                <div class="beat-display">
                    <span id="beatCounter">1.1.1</span>
                </div>
            </div>
            
            <!-- Right Controls -->
            <div class="top-right-controls">
                <button id="downloadBtn" class="btn-download" disabled>üíæ Export MP3</button>
                <button id="guideToggle" class="btn-icon" title="Help">‚ùì</button>
            </div>
        </div>

        <!-- Main Layout (3 columns) -->
        <div class="main-layout">
            
            <!-- LEFT PANEL: Channel Rack (Instruments) -->
            <div class="left-panel">
                <div class="panel-header">
                    <h2>üéπ Channels</h2>
                    <button id="addChannelBtn" class="btn-add">+</button>
                </div>
                
                <div class="channels-list" id="channelsList">
                    <!-- Channels will be added here dynamically -->
                </div>
            </div>
            
            <!-- CENTER PANEL: Piano Roll / Pattern Editor -->
            <div class="center-panel">
                <div class="panel-header">
                    <h2>üéº Piano Roll</h2>
                    <div class="piano-roll-controls">
                        <label>Grid:</label>
                        <select id="gridSelect">
                            <option value="16">16th</option>
                            <option value="8">8th</option>
                            <option value="4" selected>4th</option>
                        </select>
                        <label>Bars:</label>
                        <select id="barsSelect">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="4" selected>4</option>
                            <option value="8">8</option>
                        </select>
                    </div>
                </div>
                
                <!-- Piano Roll Grid -->
                <div class="piano-roll-container" id="pianoRollContainer">
                    <div class="piano-keys" id="pianoKeys">
                        <!-- Piano keys will be generated here -->
                    </div>
                    <div class="grid-container" id="gridContainer">
                        <!-- Grid will be generated here -->
                    </div>
                </div>
                
                <!-- Live Piano Keyboard -->
                <div class="piano-keyboard">
                    <div class="keyboard-label">Live Keyboard (A-K keys)</div>
                    <div class="piano" id="livePiano">
                        <div class="white-key" data-note="C4" data-key="a">C</div>
                        <div class="black-key" data-note="C#4" data-key="w"></div>
                        <div class="white-key" data-note="D4" data-key="s">D</div>
                        <div class="black-key" data-note="D#4" data-key="e"></div>
                        <div class="white-key" data-note="E4" data-key="d">E</div>
                        <div class="white-key" data-note="F4" data-key="f">F</div>
                        <div class="black-key" data-note="F#4" data-key="t"></div>
                        <div class="white-key" data-note="G4" data-key="g">G</div>
                        <div class="black-key" data-note="G#4" data-key="y"></div>
                        <div class="white-key" data-note="A4" data-key="h">A</div>
                        <div class="black-key" data-note="A#4" data-key="u"></div>
                        <div class="white-key" data-note="B4" data-key="j">B</div>
                        <div class="white-key" data-note="C5" data-key="k">C</div>
                    </div>
                </div>
            </div>
            
            <!-- RIGHT PANEL: Mixer -->
            <div class="right-panel">
                <div class="panel-header">
                    <h2>üéöÔ∏è Mixer</h2>
                </div>
                
                <div class="mixer-channels" id="mixerChannels">
                    <!-- Mixer channels will be added here dynamically -->
                </div>
                
                <!-- Master Channel -->
                <div class="mixer-channel master-channel">
                    <div class="channel-name">Master</div>
                    <input type="range" id="masterVolume" class="volume-slider vertical" 
                           min="0" max="1" value="0.7" step="0.01" orient="vertical">
                    <div class="volume-label" id="masterVolumeLabel">70%</div>
                </div>
            </div>
            
        </div>

        <!-- Guide Overlay (hidden by default) -->
        <div id="guideOverlay" class="guide-overlay hidden">
            <div class="guide-content">
                <button class="close-guide" id="closeGuide">‚úï</button>
                <h2>üéµ How to Use Music Studio</h2>
                
                <div class="guide-section">
                    <h3>1Ô∏è‚É£ Add Instruments</h3>
                    <p>Click the <strong>+ button</strong> in the Channels panel to add new instruments (Lead, Bass, Pad, Drums, etc.)</p>
                </div>
                
                <div class="guide-section">
                    <h3>2Ô∏è‚É£ Select & Configure</h3>
                    <p>Click on a channel to select it. Adjust its wave type, attack, release, and volume in the channel settings.</p>
                </div>
                
                <div class="guide-section">
                    <h3>3Ô∏è‚É£ Play Notes</h3>
                    <p>Use the <strong>live keyboard</strong> at the bottom or your computer keyboard (A-K) to play notes with the selected instrument.</p>
                </div>
                
                <div class="guide-section">
                    <h3>4Ô∏è‚É£ Draw Patterns</h3>
                    <p>Click on the <strong>piano roll grid</strong> to place notes. They will loop automatically.</p>
                </div>
                
                <div class="guide-section">
                    <h3>5Ô∏è‚É£ Mix Your Track</h3>
                    <p>Use the <strong>mixer panel</strong> on the right to adjust volume levels and mute/solo channels.</p>
                </div>
                
                <div class="guide-section">
                    <h3>6Ô∏è‚É£ Record & Export</h3>
                    <p>Click the <strong>Record button</strong> ‚è∫Ô∏è to start recording. When done, click <strong>Export MP3</strong> to download your track!</p>
                </div>
                
                <div class="guide-section">
                    <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                    <ul>
                        <li><strong>Space</strong> - Play/Pause</li>
                        <li><strong>A-K</strong> - Play notes (C to C)</li>
                        <li><strong>W, E, T, Y, U</strong> - Black keys (sharps)</li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

    <!-- Tone.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    
    <!-- Lame.js for MP3 encoding -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lamejs/1.2.0/lame.min.js"></script>
    
    <!-- Application Script -->
    <script src="app.js"></script>
</body>
</html>
